use businessDB;

if EXISTS (select * from VENDOR)
    DELETE from VENDOR;
    
if EXISTS (select * from PRODUCT)
    DELETE from PRODUCT;

begin TRANSACTION;

INSERT into VENDOR 
    VALUES (21225, 'Antonio Fabricio', 'antonio.f@nutrihuse.com', '310', '34348569', 'ER', 'A');

SELECT * from VENDOR;

INSERT INTO VENDOR
	VALUES (21226, 'Federico Perez', 'federico.p@laloma.com', '310', '34323545', 'ER', 'B');

SELECT * FROM VENDOR

INSERT INTO VENDOR
	VALUES 
	(21227, 'Daniel Monsalve', 'daniel.m@laloma.com', '310', '34323545', 'ER', 'C'),
	(21228, 'Carlos Gimenez', 'carlos.g@nutrihuse.com', '310', '34348569', 'ER', 'D'),
	(21229, 'Maria Dugarte', 'mari.d@fs.com', '310', '34234541', 'ER', 'E');

SELECT * FROM VENDOR


INSERT INTO PRODUCT
	VALUES
	(1, 'Pintura 3 en 1 anti oxidante','2023-04-24T12:30:00', 30, NULL, 3500, NULL, 21228),
	(2, 'Pincel de 20"','2023-04-24T12:40:00', 2, 200, 350, 5, 21229);

SELECT * FROM PRODUCT
 
INSERT INTO PRODUCT	
	(P_CODE, P_DESCRIPT, P_INDATE, P_PRICE) VALUES (3, 'Solvente de Pintura Thinner','2023-04-24T14:30:00', 700);

SELECT * FROM PRODUCT

SELECT P_CODE, P_DESCRIPT, P_INDATE, P_QOH, P_MIN
FROM PRODUCT;

SELECT * FROM PRODUCT


UPDATE VENDOR
	SET V_STATE = 'BA'
	WHERE V_CODE = 21225;

SELECT * FROM VENDOR;

UPDATE PRODUCT
	SET P_INDATE = '2023-05-24T13:00:00', P_QOH = 5, P_PRICE = 4500
	WHERE P_CODE = 1;

SELECT * FROM PRODUCT;
	
SELECT * FROM VENDOR;

INSERT INTO PRODUCT (V_CODE, P_CODE, P_DESCRIPT, P_INDATE, P_PRICE)
SELECT V_CODE, 4, 'Bolsa de cemento de 50kg', '2023-04-24T12:00:00', 2500
FROM VENDOR
WHERE V_NAME = 'Federico Perez';

SELECT * FROM PRODUCT


UPDATE PRODUCT
	SET P_INDATE = '2023-05-24T13:00:00', P_QOH = 5, P_PRICE = 1114500
	WHERE P_CODE = 1;
SELECT * FROM PRODUCT;

ROLLBACK TRANSACTION;
SELECT * FROM PRODUCT;


BEGIN TRANSACTION;
UPDATE PRODUCT
	SET P_INDATE = '2023-05-24T13:00:00', P_QOH = 5, P_PRICE = 5000
	WHERE P_CODE = 1;
SELECT * FROM PRODUCT;
COMMIT TRANSACTION;

DELETE FROM PRODUCT WHERE P_CODE = 4;
SELECT * FROM PRODUCT;